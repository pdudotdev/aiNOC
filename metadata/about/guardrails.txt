  Agent Autonomy Approval                                                                                                                                                                                                                       
   
  - ✓ Explicit no-auto-push rule: "Always ask the user whether to proceed before calling push_config" (mandatory, stated twice in CLAUDE.md)                                                                                                      
  - ✓ Permission-based tool system: User can deny any tool call (Edit, Bash, push_config); agent must handle gracefully and skip that step                                                                                                        
  - ✓ Maintenance window enforcement: push_config tool itself checks MAINTENANCE.json and blocks out-of-window changes (read-only file, agent can't bypass)                                                                                       
                                                                                                                                                                                                                                                  
  Agent Storms & Duplicate Invocations                                                                                                                                                                                                            
                                                                                                                                                                                                                                                  
  - ✓ Lock file mechanism (oncall.lock): Single-instance guard prevents multiple agents from running simultaneously                                                                                                                               
  - ✓ PID liveness check (is_lock_stale()): Detects dead processes; cleans stale locks automatically instead of deadlocking
  - ✓ Deferred events handling (pending_events.json): Events arriving during active session are captured and deferred for review, not lost or re-triggered                                                                                        
  - ✓ Drain mechanism (drain[0] flag): After session ends, watcher seeks to EOF to skip buffered events—prevents re-processing the same failure N times                                                                                           
                                                                                                                                                                                                                                                  
  Command Repetition & Redundant Investigation                                                                                                                                                                                                    
                                                                                                                                                                                                                                                  
  - ✓ Core Troubleshooting Methodology (6 principles): Ordered, deterministic workflow—stops repetition by enforcing:                                                                                                                             
    - P1: Map expected path from INTENT.json (investigation scope defined upfront)                                                                                                                                                                
    - P2: Single localization step via one traceroute (prevents N traceroutes)                                                                                                                                                                    
    - P3: Mandatory basics-first gate (get_interfaces + get_neighbors before deeper tools)
    - P4: "Never chase downstream"—missing route → check source's neighbors only                                                                                                                                                                  
    - P5: "One device at a time"—fully resolve before moving on                                                                                                                                                                                   
    - P6: "Simple before complex"—ordered 10-item checklist, stops at first mismatch                                                                                                                                                              
  - ✓ Decision gates in Principle 3: If interfaces down → stop; if neighbors missing → go directly to Adjacency Checklist (skips LSDB, redistribution, policies)                                                                                  
                                                                                                                                                                                                                                                  
  Hallucinations & Off-Scope Investigation                                                                                                                                                                                                        
                                                                                                                                                                                                                                                  
  - ✓ Explicit scope_devices list in sla_paths/paths.json: Each SLA path defines exact investigation boundary; Pitfall #8 warns against out-of-scope devices                                                                                      
  - ✓ INTENT.json context requirement: Principle 1 mandates reading intent before any device query (prevents making up device roles/areas)
  - ✓ Skill prerequisites: Each protocol skill requires basics-first gate; skipping it blocked by PREREQUISITE note at top
  - ✓ Pitfall #10: "Do not skip adjacency check before protocol skill deep-dive"—prevents premature LSDB reading

  Increased Costs & Tool Misuse

  - ✓ MCP tool map (platforms/mcp_tool_map.json): Maps every tool to its queries; Pitfall #1 mandates checking this before falling back to run_show (cheaper, targeted tools first)
  - ✓ Prohibition on Task subagents for MCP calls: Pitfall #6 forbids using subagents for network operations (they don't inherit MCP connection; forces direct main-session calls—faster, cheaper)
  - ✓ Prohibition on Bash SSH to devices: Pitfall #5 forbids bypassing MCP abstraction layer (prevents uncontrolled SSH storms)

  Case Documentation & Lesson Hallucinations

  - ✓ Mandatory case documentation: Every case appended to cases/cases.md with 5-digit sequential ID (prevents duplicate documentation, allows lesson mining)
  - ✓ Lessons curation: cases/lessons.md is pre-curated (top 10 lessons from past cases); agent must read it at session start and decide if new lesson promotes old ones (prevents invented "lessons")
  - ✓ Case format structure: Standardized schema (cases/case_format.md) enforces consistency, prevents ad-hoc note-taking
  - ✓ Task tracking for documentation: Documentation marked as final task in case checklist—prevents session closure without documentation

  Policy Integrity

  - ✓ Read-only policy files: MAINTENANCE.json, inventory/NETWORK.json, intent/INTENT.json are not writable by agent (prevents accidental or intentional policy drift)
  - ✓ Vector config is external: Log pipeline (/etc/vector/vector.yaml) is managed outside agent—cannot be corrupted or modified

  On-Call Mode Isolation

  - ✓ Focus enforcement: "You will NOT be invoked or deviated from the current case, even if a new issue occurs in the meantime" (prevents multi-tasking, context loss)
  - ✓ Deferred review workflow: Events during session become a separate second session (prevents abandoning deferred failures)

  Command Caching (MCP Server)
  - ✓ 5-second command-level cache: Prevents re-querying the same device with the identical command within 5 seconds (keyed by (device, command)), which avoids unnecessary repetition (costs).                                                                                               
  - ✓ Cache hit skips device connection entirely: If the exact same device+command is requested within 5 seconds, returns cached result without connecting to device; run_show excluded (ttl=0).
